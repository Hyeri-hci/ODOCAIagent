# Diagnosis Configuration v2
# 모든 임계값과 가중치를 한 곳에서 관리
# 주간 ±0.02~0.05 범위에서 조정, 변경 이력 남길 것

# README 우선순위
readme:
  prefer:
    - "README.md"
    - "README_ko.md"
    - "README_en.md"

# 마케팅 편향 설정
marketing:
  threshold: 0.6 # tech_ratio 임계값 (이하면 페널티)
  penalty_cap: 0.4 # 페널티 상한
  template_bonus: 0.05 # 템플릿 유사도 > 0.9 시 추가 페널티

  # Phase 2 추가: 마케팅 페널티 세부 설정
  max_penalty: 30 # 최대 페널티 점수
  density_threshold: 0.08 # 마케팅 밀도 임계값
  unlinked_bullet_threshold: 5 # 비연결 불릿 임계값
  badge_threshold: 8 # 배지 과다 임계값
  template_similarity_threshold: 0.6 # 템플릿 유사도 임계값

# 템플릿 유사도
templates:
  similarity_threshold: 0.9 # 이 이상이면 템플릿 의심
  allowlist: [] # 합법 템플릿 제외 목록 (sha256 해시)

# 교차검증(consilience) 가중치
consilience:
  weights:
    path: 0.4 # 파일 경로 검증
    workflow: 0.35 # 워크플로/배지 검증
    link: 0.25 # 외부 링크 검증
  timeout_seconds: 2.0
  link_timeout_seconds: 1.5
  cache_ttl_hours: 24

# 문서 최신성
freshness:
  tau: 60 # 감쇠 상수 (일)

# 유효 문서 점수
docs:
  floor: 35 # 바닥값
  weights:
    raw: 0.55
    consilience: 0.25
    freshness: 0.20

  # Phase 2 추가: docs_effective 계산용
  tech_score_weights:
    code_blocks: 25
    commands: 20
    path_refs: 15
    platforms: 15
    density: 25

  effective_weights:
    raw: 0.3
    tech: 0.4
    consilience: 0.3

# 지속성 게이트 (Sustainability Gate)
# 출처: CHAOSS Metrics, GitHub Octoverse 2023, GitHub Archive Program
gate:
  # === 활동성 임계값 ===
  # 출처: GitHub Octoverse "최근 활동" 정의
  active_threshold_days: 30 # 30일 내 커밋 = 활성

  # 출처: 일반적인 분기별 릴리스 주기
  maintained_threshold_days: 90 # 90일 내 커밋 = 유지보수 중

  # 출처: GitHub Archive Program "1년 내 활동" 기준
  stale_threshold_days: 365 # 365일 초과 = 사실상 중단

  # 필수 게이트: 마지막 커밋 임계값
  commit_recency_days: 365 # Archive 기준과 동일

  # === 최소 요구사항 ===
  # 출처: GitHub Archive Program 선정 기준
  min_commits: 10 # 최소 커밋 수 (합리적 추정)
  min_authors: 2 # Archive 기준: 2명 이상 기여자

  # === 반응성 ===
  # 출처: CHAOSS "Issue Resolution Efficiency" 메트릭
  # - good: < 48시간, acceptable: < 168시간 (7일)
  time_to_first_response_hours: 48
  median_first_response_days: 7 # 7일 = acceptable

  # === 활동량 ===
  # 출처: 학술 연구 "주 1회 이상 커밋 = 활성" (Jansen et al. 2020)
  commit_rate_per_week_90d: 1.0 # 주 1회
  issue_or_pr_rate_per_week_90d: 0.5

  # === 위험 지표 ===
  # 출처: CHAOSS Risk Metrics "Bus Factor"
  # - healthy: >= 3명, risky: 1명
  bus_factor_warning: 2 # 2명 미만이면 경고

  # === 기타 설정 ===
  recency_days: 90
  last_release_days: 180
  unique_contributors_90d: 1
  stars_delta_180d: 0
  early_stage_days: 60
  archived_fail: true

# 기술 신호 패턴 (정규식)
tech_patterns:
  commands:
    - "pip install"
    - "npm install"
    - "yarn add"
    - "pnpm add"
    - "docker (build|run|compose)"
    - "make\\s+\\w+"
    - "pytest"
    - "python -m"
    - "uvicorn"
    - "poetry (install|add)"
    - "cargo (build|run)"
    - "go (build|run|get)"

  paths:
    - "src/"
    - "app/"
    - "lib/"
    - "examples/"
    - "tests/"
    - "docs/"
    - "\\.github/workflows/"
    - "scripts/"

# 마케팅 키워드 (기본, 상세는 별도 yaml)
marketing_keywords:
  en:
    - "revolutionary"
    - "game-changer"
    - "cutting-edge"
    - "next-generation"
    - "one-click"
    - "seamless"
    - "blazing fast"
    - "enterprise-grade"
    - "world-class"
    - "best-in-class"
  ko:
    - "혁신적"
    - "차세대"
    - "원클릭"
    - "손쉽게"
    - "획기적"
    - "완벽한"
    - "최고의"
    - "강력한"
    - "놀라운"
